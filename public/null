$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

User::find(2)
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => $get('competency_id'),
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$resultArray
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$resultArray->toArray()
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$resultArray->toJson()
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$resultArray->toArray()
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }
$resultArray;
$teacherSubject = TeacherSubject::with([
'grade.studentGrade.student', 'grade.studentGrade.studentCompetency' => function($query){
	$query->where('competency_id',4);
}])
->find(22);

$students = $teacherSubject->grade->studentGrade;

$resultArray = [];

                        foreach ($students as $studentGrade) {
                            $score = 0; 
                        
                            if ($studentGrade->studentCompetency && $studentGrade->studentCompetency->score) {
                                $score = $studentGrade->studentCompetency->score;
                            }
                        
                            $resultArray[] = [
                                'competency_id' => 4,
                                'student_id' => $studentGrade->student_id,
                                'score' => $score
                            ];
                        }

$jsonResult = json_encode($resultArray);
